## Janus Project: Export File JSON Specification

This document defines the structure of the JSON file generated by the `janus export` command. The purpose of this format is to create a single, self-contained, and portable artifact that represents a complete experiment, including all its components and results.

### Top-Level Object

The root of the JSON file is an object with the following properties:

| Key                    | Type   | Description                                                                                              |
| ---------------------- | ------ | -------------------------------------------------------------------------------------------------------- |
| `janus_export_version` | string | The version of the export format schema. This allows for backward compatibility as the format evolves.   |
| `exported_at`          | string | An ISO 8601 timestamp indicating when the file was generated.                                            |
| `data`                 | object | The main container for all the exported entities and their relationships, representing a graph snapshot. |

---

### The `data` Object

The `data` object contains two primary keys: `nodes` and `relationships`.

#### `data.nodes`

An object containing arrays of all the exported entities, grouped by their type.

- **`content_nodes`**: `array` of ContentNode objects.
- **`content_node_versions`**: `array` of ContentNodeVersion objects.
- **`test_cases`**: `array` of TestCase objects.
- **`test_runs`**: `array` of TestRun objects.
- **`data_points`**: `array` of DataPoint objects.
- **`tags`**: `array` of Tag objects.

Each object within these arrays conforms to the structure defined in the `DOMAIN_MODEL.md` specification.

#### `data.relationships`

An array of objects, where each object defines a single relationship between two nodes in the snapshot. This is the "glue" that reconstructs the graph structure.

Each relationship object has the following structure:

| Key          | Type   | Description                                                                                                                           |
| ------------ | ------ | ------------------------------------------------------------------------------------------------------------------------------------- |
| `from`       | string | The UUID of the starting node for the relationship.                                                                                   |
| `to`         | string | The UUID of the ending node for the relationship.                                                                                     |
| `type`       | string | The type of the relationship. See the list of valid types below.                                                                      |
| `properties` | object | (Optional) A key-value map of any properties stored on the relationship itself (e.g., `role` and `sequence` for the `INCLUDES` type). |

**Valid Relationship `type` values:**
`VERSION_OF`, `PREVIOUS_VERSION`, `INCLUDES`, `GENERATED`, `USING_TEST_CASE`, `USED_CONTENT`, `HAS_TAG`.

---

### Example Export File

Here is a concrete example of an exported JSON file representing a small experiment.

```json
{
  "janus_export_version": "1.0",
  "exported_at": "2025-07-03T12:00:00Z",
  "data": {
    "nodes": {
      "content_nodes": [
        {
          "id": "content-node-uuid-01",
          "name": "formal-greeting-persona",
          "description": "A formal, professional persona for starting a prompt."
        },
        {
          "id": "content-node-uuid-02",
          "name": "user-name",
          "description": "The name of the user to address."
        }
      ],
      "content_node_versions": [
        {
          "id": "content-version-uuid-01a",
          "content": "You are a professional assistant. Your tone should be formal and respectful. The user's name is {{user_name}}.",
          "createdAt": "2025-07-02T10:00:00Z",
          "commitMessage": "Initial version of formal persona."
        },
        {
          "id": "content-version-uuid-02a",
          "content": "Alice",
          "createdAt": "2025-07-02T10:30:00Z",
          "commitMessage": "Default user name."
        }
      ],
      "test_cases": [
        {
          "id": "test-case-uuid-01",
          "name": "formal-greeting-test",
          "description": "A simple test for the formal greeting.",
          "createdAt": "2025-07-02T11:00:00Z",
          "llmModel": "gpt-4",
          "messageSlots": [
            {
              "role": "system",
              "tags": ["tag-uuid-01"],
              "sequence": 0
            }
          ]
        }
      ],
      "test_runs": [
        {
          "id": "test-run-uuid-01",
          "name": "Initial Formal Greeting Test",
          "createdAt": "2025-07-03T11:30:00Z",
          "llm_provider": "openai",
          "llm_model": "gpt-4o-2024-05-13",
          "metadata": { "team": "red-team", "sprint": "sprint-5" }
        }
      ],
      "data_points": [
        {
          "id": "datapoint-uuid-01",
          "final_prompt_text": "You are a professional assistant. Your tone should be formal and respectful. The user's name is Alice.",
          "response_text": "Hello, Alice. How may I assist you today?",
          "metrics": { "latency_ms": 850, "completion_tokens": 12 }
        }
      ],
      "tags": [
        {
          "id": "tag-uuid-01",
          "name": "formal-persona"
        }
      ]
    },
    "relationships": [
      {
        "from": "content-version-uuid-01a",
        "to": "content-node-uuid-01",
        "type": "VERSION_OF"
      },
      {
        "from": "content-version-uuid-02a",
        "to": "content-node-uuid-02",
        "type": "VERSION_OF"
      },
      {
        "from": "content-version-uuid-01a",
        "to": "content-version-uuid-02a",
        "type": "INCLUDES",
        "properties": { "operation": "insert", "key": "user_name" }
      },
      {
        "from": "content-node-uuid-01",
        "to": "tag-uuid-01",
        "type": "HAS_TAG"
      },
      {
        "from": "test-run-uuid-01",
        "to": "datapoint-uuid-01",
        "type": "GENERATED"
      },
      {
        "from": "datapoint-uuid-01",
        "to": "test-case-uuid-01",
        "type": "USING_TEST_CASE"
      },
      {
        "from": "datapoint-uuid-01",
        "to": "content-version-uuid-01a",
        "type": "USED_CONTENT"
      }
    ]
  }
}
```
